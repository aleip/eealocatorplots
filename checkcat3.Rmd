---
title: "checkcat3"
author: "Adrian Leip"
date: "Tuesday, July 28, 2015"
output: html_document
---

# EU-GIRP (EU-Greenhouse gas Inventory Reporting Plots; eealocatorplots)
File checkcat3
Main file required for the EU-GIRP
##Purpose: Checking MS submissions in the agriculture sector on errors,
- errors
- outliers
- trend/time series consistency

Adrian Leip <adrian.leip@jrc.ec.europa.eu>
version 3 - 28.07.2015


```{r generalSettings}
rm(list=objects())
invyear<-"c:/adrian/data/inventories/ghg/unfccc/eealocatorplots"
setwd(invyear)
source("curplot.csv")
rdatfile<-paste0(csvfil,".RData")
load(rdatfile)
alldata<-alldata[grepl("^3",alldata$sector_number),]
measureacronyms<-read.csv("measures_20150731.txt",stringsAsFactors=FALSE)
alldata<-merge(alldata,measureacronyms,by.x="measure",by.y="measname")
cat3info<-alldata[alldata$meastype=="INFO",]
cat3methods<-alldata[alldata$meastype=="METHOD",]

rdatallem <- paste0(csvfil,"_clean.RData")
    if(file.exists(rdatallem)){
        if(file.info(paste0(csvfil,".txt"))$mtime<file.info(rdatallem)$mtime){
            print(paste0("Load existing file ",rdatallem))
            load(rdatallem)    
            generatealldata <- 0
        }
    }
allcountries<-as.data.frame(unique(as.vector(alldata$party)))
names(allcountries)<-"party"
allcountries$party<-as.character(allcountries$party)
checkhead<-c("test","val1","val2","ms","sec","yr","val","obs")
nheaders<-length(checkhead)
checktemp<-as.data.frame(matrix(rep(0,nheaders),nrow=1,ncol=nheaders))
names(checktemp)<-checkhead

```

```{r extractCat3, echo=FALSE}
cat3all<-alldata[grepl("^3",alldata$sector_number),]
cat3all<-subset(cat3all,select=-unique)
years<-names(cat3all)
years<-years[grepl("^[12]",years,perl=TRUE)]
source("checkcat3_functions.r")
source("checkcat3_0animals.r")
```

### Check1: Activitydata are identic between 4A and 4B
```{r prepareAnimaltypes}

```

```{r functiongetuid}

```

```{r checkADs}
source("checkcat3_1ADs.r")
checkfile<-paste0(checkloc,"check1_ADs_tablesA-B1-B2_",cursubm,"~",figdate,".csv")
write.csv(checks,file=checkfile)

```

Check for consistency in Table B(b):
N-excretion x Population = sum(N in MMS)
```{r checkNex}
source("checkcat3_2Nex.r")
checkfile<-paste0(checkloc,"check2_TabB2_Nex_",cursubm,"~",figdate,".csv")
write.csv(checks,file=checkfile)


```




